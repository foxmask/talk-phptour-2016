<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>wallabag, comment on a migré vers symfony3</title>

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/solarized.css" id="theme">
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>
		<div style="background: url('img/bg.png'); position: absolute; width: 50px; height: 54px; bottom: 30px; left: 30px;"></div>

		<div class="reveal">
			<div class="slides">
				<section>
					<h2>wallabag : comment on a migré vers symfony3</h2>
					<p>
						<small>Par Jérémy Benoist (<a href="https://twitter.com/j0k">@j0k</a>) et Nicolas Lœuillet (<a href="https://twitter.com/nicosomb">@nicosomb</a>)</small>
					</p>
				</section>

				<section>
					<h2>Nous deux</h2>
					<p>
						<img src="img/j0k.png" /><br />
						Jérémy Benoist, lead developer chez 20minutes
					</p>
					<p>
						<img src="img/nicosomb.png" /><br />
						Nicolas Lœuillet, développeur chez Smile
					</p>
				</section>

				<section>
					<h2>Plan</h2>
					<p>
						<ul>
							<li class="fragment">fonctionnalités et histoire</li>
							<li class="fragment">la v1 : pourquoi ça n'était pas mieux avant</li>
							<li class="fragment">la v2 : pourquoi c'est mieux maintenant</li>
							<li class="fragment">bench comparatif</li>
							<li class="fragment">les étapes pour arriver à la v2</li>
							<li class="fragment">les étapes en cours</li>
							<li class="fragment">les étapes à venir</li>
						</ul>
					</p>
				</section>

				<section>
					<h2>Fonctionnalités et histoire</h2>
					<h3>Ce que ça fait</h3>
					<table>
						<tr>
							<td><img src="img/wallabag_website_features_1.png" /></td>
							<td><img src="img/wallabag_website_features_2.png" /></td>
						</tr>
						<tr>
							<td><img src="img/wallabag_website_features_3.png" /></td>
							<td><img src="img/wallabag_website_features_4.png" /></td>
						</tr>
						<tr>
							<td colspan="2" align="center"><img src="img/wallabag_website_features_5.png" /></td>
						</tr>
					</table>

				    <aside class="notes">
				        wallabag est un read-it-later, une application de lecture différée : vous y stockez un article pour le lire plus tard, le contenu de l'article sera stocké et uniquement le contenu (wallabag supprimera tout ce qui est superflu, comme la publicité par exemple). Puisque wallabag existe en tant qu'application web et sur nos smartphones, vous retrouverez ces articles synchronisés automatiquement sur votre téléphone. 
				    </aside>
				</section>

				<section>
					<h2>Fonctionnalités et histoire</h2>
					<h3>Histoire</h3>
					<p><img src="img/poche.jpg" /></p>

				    <aside class="notes">
				        En mars 2013, Google annonce la fermeture de l'un de ses services les plus populaires : Google Reader. À l'époque utilisateur de Pocket, un très bon service de read-it-later mais fermé et propriétaire, je me suis demandé ce que j'allais devenir si mon deuxième service préféré fermait du jour au lendemain. C'est ainsi qu'en avril 2013, poche, petite alternative sans prétention, est née. 
						Rapidement, via le planet libre, quelques retours sont faits, quelques idées sont proposées. C'est à cette période que Thomas arrive.
						Janvier 2014, un tweet (https://twitter.com/wallabagapp/status/423786365944225792 ) est mal interprété par Pocket : ils nous contactent donc pour nous demander de : 
						* changer de nom
						* changer de logo
						* ne plus utiliser le terme read it later (marque déposée)
						* ne plus dire qu'ils sont non free
						Brainstorming avec les utilisateurs de poche : un nouveau nom est trouvé, wallabag. Un logo est créé par une bénévole. 
						Début 2015, on s'active vraiment pour la v2, avec l'arrivée de Jérémy dans l'équipe https://github.com/wallabag/wallabag/pull/1049 
						Première alpha, septembre 2015
						v2 livrée le 3 avril 2016, trois ans jour pour jour après le tout premier commit.  
				    </aside>
				</section>

				<section>
					<section>
						<h2>Pourquoi ça n'était pas mieux avant</h2>
						<p><img src="img/wllbgv1.png" /></p>
					</section>

					<section>
						<h2>Pourquoi ça n'était pas mieux avant</h2>
						<h3>Version de PHP</h3>

						<ul>
							<li>PHP >= 5.3.3</li>
							<li>Pas de framework</li>
							<li>Des classes PHP de plusieurs centaines de lignes</li>
						</ul>

					</section>

					<section>
						<h2>Pourquoi ça n'était pas mieux avant</h2>
						<h3>Fréquence des mises à jour</h3>
						<ul>
							<li>Pas de calendrier défini</li>
							<li>10 versions mineures en deux ans</li>
							<li>Versions correctives qui apportaient de nouvelles fonctionnalités, pas de vrai respect de SEMVER</li>
						</ul>
					</section>

					<section>
						<h2>Pourquoi ça n'était pas mieux avant</h2>
						<h3>Qualité du code</h3>
						<ul>
							<li>396 fichiers</li>
							<li>95.788 lignes de code</li>
							<li>37.902 lignes de code</li>
						</ul>
					</section>

					<section>
						<h2>Pourquoi ça n'était pas mieux avant</h2>
						<h3>Lacunes techniques</h3>
						<ul>
							<li>Pas d'API</li>
							<li>Pas de tests</li>
							<li>Pas de pull requests par l'équipe</li>
							<li>Déploiement manuel via Filezilla</li>
							<li>Équipe de deux personnes</li>
						</ul>
					</section>
				</section>

				<section>
					<section>
						<h2>Pourquoi c'est mieux maintenant</h2>
						<p><img src="img/wllbgv2.png" /></p>
					</section>

					<section>
						<h2>Pourquoi c'est mieux maintenant</h2>
						<h3>Version de PHP</h3>
							<li>PHP >= 5.5.9</li>
							<li>Compatible PHP7</li>
							<li>Symfony3</li>
					</section>

					<section>
						<h2>Pourquoi c'est mieux maintenant</h2>
						<h3>Fréquence des mises à jour</h3>
						<ul>
							<li>Roadmap établie</li>
							<li>Une version mineure tous les trois mois</li>
						</ul>
					</section>

					<section>
						<h2>Pourquoi c'est mieux maintenant</h2>
						<h3>Qualité du code</h3>
						<ul>
							<li>129 fichiers</li>
							<li>95.788 lignes de code</li>
							<li>8.822 lignes de code</li>
						</ul>
					</section>

					<section>
						<h2>Pourquoi c'est mieux maintenant</h2>
						<h3>On comble les lacunes techniques</h3>
						<ul>
							<li>
								Sorte de Definition of Done pour chaque commit :
								<ul>
									<li>Documentation utilisateur</li>
									<li>Tests unitaires et fonctionnels (+ validation des fichiers de trads)</li>
									<li>Relecture de la pull request</li>
								</ul>
							</li>
							<li>Déploiement via Capistrano</li>
							<li>Le moins d'actions manuelles possibles pour la gestion du projet</li>
							<li>Équipe plus conséquente : une core team, des traducteurs, des développeurs</li>
						</ul>
					</section>
				</section>

				<section>
					<section>
						<h2>Bench comparatif</h2>
						<h3>Liste d'articles</h3>
						<p>wallabag v1</p>
						<ul>
							<li>80 ms</li>
							<li>9 Mo</li>
						</ul>
						<p>wallabag v2</p>
						<ul>
							<li>330 ms (dont 215 ms pour Symfony)</li>
							<li>16 Mo</li>
						</ul>
					</section>
				</section>

				<section>
					<section>
						<h2>Les étapes pour arriver à la v2</h2>
						<h3>Choix du framework</h3>

						<aside class="notes">
							Rapidement, (3 ou 4 mois après la toute première version de la v1), une refonte s'est fait sentir. Mais Nicolas n'avait pas les compétences pour se lancer dans le chantier tout seul. Plusieurs pistes : changement de technos, micro frameworks PHP, Symfony, etc. 
							Une première ébauche de refonte avec Symfony a été démarrée avec Vincent Jousse, mais faute de temps, il a du quitter le projet. 
							Puis est arrivé Jérémy 
						</aside>
					</section>

					<section>
						<h2>Les étapes pour arriver à la v2</h2>
						<h3>Adaptation de Full-Text RSS => Graby (mi avril 2015)</h3>
						<ul>
							<li>Mise en place de test fonctionnels sur l'existant</li>
							<li>Ré-organisation / refonte</li>
							<li>SiteConfig chargé via composer</li>
						</ul>
					</section>

					<section>
						<h2>Les étapes pour arriver à la v2</h2>
						<h3>Lib utilisées pour l'API</h3>
						<ul>
							<li>RestBundle</li>
							<li>CorsBundle</li>
							<li>OAuthBundle</li>
							<li>HateoasBundle</li>
							<li>ApiDocBundle</li>
						</ul>
					</section>

					<section>
						<h2>Les étapes pour arriver à la v2</h2>
						<h3>Listing des features par lib</h3>
						<ul>
							<li>Utilisateur => FosUserBundle</li>
							<li>Filtre => FormFilterBundle</li>
							<li>Changement de thème => LiipThemeBundle</li>
							<li>Export => phpepub, tcpdf, php-mobi</li>
							<li>Rule => RulerZ</li>
							<li>Maintenance => MaintenanceBundle</li>
							<li>Two factor authentication => TwoFactorBundle</li>
							<li>Annotations => AnnotatorJS</li>
						</ul>
					</section>

					<section>
						<h2>Les étapes pour arriver à la v2</h2>
						<h3>Difficultés</h3>

					</section>
				</section>

				<section>
					<h2>Les étapes en cours</h2>
					<ul>
						<li>RabbitMQ</li>
						<li>Elasticsearch</li>
					</ul>
				</section>

				<section>
					<h2>Les étapes à venir</h2>
					<ul>
						<li>Front en React</li>
						<li>Intégration de wallabag dans des applis tierces</li>
						<li>SaaS</li>
					</ul>
				</section>

				<section>
					<h2>Questions ?</h2>
				</section>

			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>

			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({

				controls: true,
				progress: true,
				history: true,
				center: true,

				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true }
				]
			});

		</script>

	</body>
</html>
